
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>CCCB Amplicon Variant Calling Service</title>

    <!-- Bootstrap core CSS -->
    <link href="lib/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="lib/delivery.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	<script>
		var current_div = '';
		function toggle_func(divId) {
			$("#all-div").hide();
			$("#" + current_div).toggle();
			$("#" + divId).toggle();
			current_div = divId;
		}
		function toggle_reset(){
            console.log(current_div);
            $("#" + current_div).hide();
            $("#all-div").toggle();
            current_div = 'all-div';
        }
	</script>

  </head>

  <body>

	<div id="header_div" class="simple_header">
        		<div>
            			<span class="left_header">Variant Calling Report</span>
            		</div>
            		<div>
				<span class="right_header">
					<img id="cccb_logo" src="lib/CCCB_Logo.png"></img>
		        	</span>
            		</div>
	</div>

	<div class="col-md-12" style="height: 100%">
		<div class="row" style="height: 90%;">
			<div class="col-sm-2 sidebar">
					<!-- Split button -->
					<div class="wrapper-div">
                    <div class="btn-reset" style="float: left; margin-right: 5px">
                        <button onclick="toggle_reset();" id="reset-view" type="button" class="btn btn-primary">Overview</button>
                    </div>
					<div class="btn-group" style="float: left">
					  <button id="sample-choose-dropdown" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<span class="caret"></span>
						<span class="sr-only">Toggle Dropdown</span>
					  </button>
					  <button id="sample-choose-main-button" type="button" class="btn btn-primary">Samples</button>
					  <ul class="dropdown-menu">
						{% for sample, vardict in samples.iteritems() %}
							<li onclick="toggle_func('{{vardict['samplename']}}-div');"><a href="#">{{vardict['samplename']}}</a></li>
						{% endfor %}
					  </ul>
					</div>
					</div>

		            <div onclick="toggle_func('about-div');" class="clickable-div" style="clear: both;">
		            	<span class="glyphicon glyphicon-question-sign" aria-hidden="true" style="padding-right:5px;"></span>
						About  
		            </div>
			</div>
			<div id="about-div" class="col-sm-10 main-frame hidden-div">				
				<p>
					<h3>This page contains variants generated by VarScan2. Please cite:</h3>
					<div class="well well-sm">
						<blockquote>
							<strong>Koboldt, D., Zhang, Q., Larson, D., Shen, D., McLellan, M., Lin, L., Miller, C., Mardis, E., Ding, L., & Wilson, R.</strong><br/>
							VarScan 2: Somatic mutation and copy number alteration discovery in cancer by exome sequencing.<br/>
							Genome Research 2012 DOI: 10.1101/gr.129684.111 PubMed PMID: 28125460
						</blockquote>
					</div>
				</p>
			</div>
			<div id="all-div" class=class="col-sm-10 main-frame hidden-div">
				<table class="table">
					<TR>
						<TD class="c1"><b>sample</b></TD>
						<TD class="c2"><b>chrom</b></TD>
						<TD class="c3"><b>position</b></TD>
						<TD class="c4"><b>ref allele</b></TD>
						<TD class="c5"><b>alt allele</b></TD>
						<TD class="c6"><b>alt freq</b></TD>
						<TD class="c7"><b>p value</b></TD>
						<TD class="c8"><b>total depth</b></TD>
						<TD class="c9"><b>ref depth</b></TD>
						<TD class="c10"><b>alt depth</b></TD>
					</TR>
					{% for sample, vardict in samples.iteritems() %}
						{% if vardict['variants']|length > 0 %}
							{% for snp in vardict['variants'] %}
								<TR>
									<TD class="c1">{{vardict.samplename}}</TD>
									<TD class="c2">{{snp.chrom}}</TD>
									<TD class="c3">{{snp.pos}}</TD>
									<TD class="c4">{{snp.ref}}</TD>
									<TD class="c5">{{snp.alt}}</TD>
									<TD class="c6">{{snp.freq}}</TD>
									<TD class="c7">{{snp.pval}}</TD>
									<TD class="c8">{{snp.total_depth}}</TD>
									<TD class="c9">{{snp.ref_depth}}</TD>
									<TD class="c10">{{snp.allele_depth}}</TD>
								</TR>
							{% endfor %}
							<TR style="height: 5px; border-top: 5px solid lightgrey"></TR>
						{% endif %}
					{% endfor %}
				</table>
			</div>
			{% for sample, vardict in samples.iteritems() %}
			<div id="{{vardict['samplename']}}-div" class="col-sm-10 main-frame hidden-div">
				<h3>{{vardict['samplename']}}</h3>
				<h4>
					<a href="{{vardict['bamfile']}}">Bam file</a><br>
					<a href="{{vardict['snpvcf']}}">SNPs VCF file</a><br>
					<a href="{{vardict['indelvcf']}}">Indels VCF file</a><br>
				</h4>
				{% for plot in vardict['plots'] %}
					<div class="row">
						<div class="col-sm-4"><img src="{{plot}}" class="example-img"></img></div>
					</div>
				{% endfor %}
				{% set header = vardict['header'] %}
				<table class="table">
					<TR>
						<TD class="c1"><b>{{header.chrom}}</b></TD>
						<TD class="c2"><b>{{header.pos}}</b></TD>
						<TD class="c3"><b>{{header.ref}}</b></TD>
						<TD class="c4"><b>{{header.alt}}</b></TD>
						<TD class="c5"><b>{{header.freq}}</b></TD>
						<TD class="c6"><b>{{header.pval}}</b></TD>
						<TD class="c7"><b>{{header.total_depth}}</b></TD>
						<TD class="c8"><b>{{header.ref_depth}}</b></TD>
						<TD class="c9"><b>{{header.allele_depth}}</b></TD>
					</TR>
					{% for snp in vardict['variants'] %}
						<TR>
							<TD class="c1">{{snp.chrom}}</TD>
							<TD class="c2">{{snp.pos}}</TD>
							<TD class="c3">{{snp.ref}}</TD>
							<TD class="c4">{{snp.alt}}</TD>
							<TD class="c5">{{snp.freq}}</TD>
							<TD class="c6">{{snp.pval}}</TD>
							<TD class="c7">{{snp.total_depth}}</TD>
							<TD class="c8">{{snp.ref_depth}}</TD>
							<TD class="c9">{{snp.allele_depth}}</TD>
						</TR>
					{% endfor %}
				</table>
			</div>
			{% endfor %}
		</div>

	</div>
<div class="back-to-top" style="display: inline;"><div id="back-to-top-wrapper"><span class="glyphicon glyphicon-menu-up"></span></div></div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="lib/js/bootstrap.min.js"></script>
	<script>
		$('.back-to-top').css({"display": "none"});
		$(document).ready(function() {
			var offset = 250;
			var duration = 200;
			$(window).scroll(function() {
				if ($(this).scrollTop() > offset) {
					$('.back-to-top').fadeIn(duration);
				} else {
				$('.back-to-top').fadeOut(duration);
				}
			});
			 
			$('.back-to-top').click(function(event) {
				event.preventDefault();
				$('html, body').animate({scrollTop: 0}, duration);
				return false;
			})
		});

	</script>
  </body>
</html>

